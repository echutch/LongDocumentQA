
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Light Attention Viewer</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #fff; color: #222; }
  .controls { margin-bottom: 15px; }
  select, input[type=number] { margin-right: 10px; padding: 4px; font-size: 1em; }
  .para { margin-bottom: 10px; padding: 8px; border-radius: 6px; cursor: default; }
  .dimmed { color: #999; background-color: #f5f5f5; }
</style>
</head>
<body>

<div class="qa-section">
  <h2>Question</h2>
  <p>What is the capital of France?</p>
  <h2>Answer</h2>
  <p>: What is the name of the?

Answer: Paris</p>
</div>

<div class="controls">
  <label>Layer:
    <select id="layerSelect"></select>
  </label>
  <label>Top N:
    <input type="number" id="topNInput" min="1" max="5" value="2" />
  </label>
</div>

<div id="docContainer"></div>

<script>
const DATA = {"meta": {"n_layers": 24, "paragraph_count": 5, "model_name": "EleutherAI/pythia-410m", "question": "What is the capital of France?", "answer": ": What is the name of the?\n\nAnswer: Paris"}, "paragraphs": ["[PASTE YOUR LONG DOCUMENT HERE, WITH PARAGRAPHS SEPARATED BY BLANK LINES]", "[SECTION 1] Berlin is the capital of Germany.", "[SECTION 2] Madrid is the capital of Spain.", "[SECTION 3] Paris is the capital of France. It is known for the Eiffel Tower.", "[SECTION 4] Rome is the capital of Italy."], "layer_para_scores": [[0.0018055927939713001, 0.004410043358802795, 0.0056541734375059605, 0.007868087850511074, 0.020862063392996788], [0.0020483394619077444, 0.007858552038669586, 0.006193720269948244, 0.005814059171825647, 0.01589786261320114], [0.0016438026214018464, 0.011306648142635822, 0.00768277095630765, 0.007615149486809969, 0.0127257714048028], [0.0013921830104663968, 0.009361141361296177, 0.005088585428893566, 0.00504098879173398, 0.01036970503628254], [0.001981280045583844, 0.009176895022392273, 0.005426601506769657, 0.00497226370498538, 0.010172520764172077], [0.00035522010875865817, 0.0018106021452695131, 0.0013966535916551948, 0.001538334647193551, 0.009896760806441307], [0.0007006179657764733, 0.002985636005178094, 0.0025417469441890717, 0.0027250011917203665, 0.006442711688578129], [0.0007480444619432092, 0.0029339762404561043, 0.0020453084725886583, 0.00206493167206645, 0.004620078019797802], [0.0008324328227899969, 0.003255374263972044, 0.0021023061126470566, 0.0021540040615946054, 0.005733379162847996], [0.0008745022350922227, 0.004173863213509321, 0.002312920056283474, 0.0024203055072575808, 0.005949683021754026], [0.0008823240641504526, 0.0025880089960992336, 0.0016868134262040257, 0.001519902260042727, 0.0031139934435486794], [0.0009011352085508406, 0.0036402817349880934, 0.00245492672547698, 0.001851439941674471, 0.0032623123843222857], [0.0018949605291709304, 0.003897947259247303, 0.0022295676171779633, 0.0021581838373094797, 0.0034042480401694775], [0.0008147729677148163, 0.0032937810756266117, 0.00218381779268384, 0.0015725053381174803, 0.004192265681922436], [0.0009032803936861455, 0.0034753819927573204, 0.0019952573347836733, 0.0014542415738105774, 0.0032870976720005274], [0.0006579995388165116, 0.002854613121598959, 0.0016561121447011828, 0.001178600243292749, 0.002843615598976612], [0.0015446068719029427, 0.004834639839828014, 0.0020413051825016737, 0.0014013188192620873, 0.002167531754821539], [0.0007175582577474415, 0.0026203827001154423, 0.001553839072585106, 0.0009870807407423854, 0.0026455398183315992], [0.0015458718407899141, 0.004442807752639055, 0.002370786154642701, 0.0013470003614202142, 0.0013466434320434928], [0.0011364667443558574, 0.0043465266935527325, 0.002348767826333642, 0.001123029855079949, 0.001972148660570383], [0.0008192815002985299, 0.0046206931583583355, 0.001456776401028037, 0.0006142350030131638, 0.0013335209805518389], [0.0017515614163130522, 0.005921679083257914, 0.002587334718555212, 0.0011510272743180394, 0.0026140729896724224], [0.00033751025330275297, 0.006051648873835802, 0.0022910083644092083, 0.0009721637470647693, 0.0007996233180165291], [2.0809902707696892e-06, 0.0015988132217898965, 0.0017969600157812238, 0.0016456920420750976, 0.004765241872519255]]};

const layerSelect = document.getElementById('layerSelect');
const topNInput = document.getElementById('topNInput');
const docContainer = document.getElementById('docContainer');

for(let i=0; i<DATA.meta.n_layers; i++){
  let opt = document.createElement('option');
  opt.value = i;
  opt.textContent = 'Layer ' + i;
  layerSelect.appendChild(opt);
}

layerSelect.value = 0;

function scoreToColor(norm) {
  norm = Math.min(Math.max(norm, 0), 1);
  let r1=255, g1=255, b1=204;
  let r2=177, g2=0, b2=38;
  let r = Math.round(r1 + (r2-r1)*norm);
  let g = Math.round(g1 + (g2-g1)*norm);
  let b = Math.round(b1 + (b2-b1)*norm);
  return "rgb(" + r + "," + g + "," + b + ")";
}

function render() {
  docContainer.innerHTML = '';
  const layer = parseInt(layerSelect.value);
  let topN = parseInt(topNInput.value);
  if(isNaN(topN) || topN < 1) topN = 1;
  if(topN > DATA.paragraphs.length) topN = DATA.paragraphs.length;
  topNInput.value = topN;

  const scores = DATA.layer_para_scores[layer];
  const maxScore = Math.max(...scores, 1e-12);

  const sortedIndices = [...scores.keys()].sort((a,b) => scores[b] - scores[a]);
  const topIndices = new Set(sortedIndices.slice(0, topN));

  for(let i=0; i<DATA.paragraphs.length; i++) {
    const p = document.createElement('div');
    p.className = 'para';
    if(topIndices.has(i)) {
      const normScore = scores[i]/maxScore;
      p.style.backgroundColor = scoreToColor(normScore);
      p.title = 'Paragraph ' + i + ' — score: ' + scores[i].toFixed(6);
    } else {
      p.classList.add('dimmed');
      p.title = 'Paragraph ' + i + ' — outside top ' + topN;
    }
    p.textContent = DATA.paragraphs[i];
    docContainer.appendChild(p);
  }
}

layerSelect.addEventListener('change', render);
topNInput.addEventListener('input', render);

render();
</script>

</body>
</html>
